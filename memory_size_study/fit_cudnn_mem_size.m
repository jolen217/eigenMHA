%% this script is for further understanding the workspace size returned by cudnnGetMultiHeadAttnBuffers()
x = [1,2,3,4,5,6,7,8];
y = [1,2,3,4,5,6,7,8];
[x2, y2] = meshgrid(x, y);

base = [24,48,72,96,120,144,168,192;
    48,96,144,192,240,288,336,384;
    72,144,216,288,360,432,504,576;
    96,192,288,384,480,576,672,768;
    120,240,360,480,600,720,840,960;
    144,288,432,576,720,864,1008,1152;
    168,336,504,672,840,1008,1176,1344;
    192,384,576,768,960,1152,1344,1536;] / 4

data = [544,608,672,736,832,896,960,1024;
    608,736,896,1024,1376,1504,1664,1792;
    672,896,1312,1504,1728,2144,2368,2560;
    736,1024,1504,1792,2272,2560,3040,3328;
    832,1376,1728,2272,2848,3200,3744,4096;
    896,1504,2144,2560,3200,3808,4448,4864;
    960,1664,2368,3040,3744,4448,5152,5632;
    1024,1792,2560,3328,4096,4864,5632,6400;] / 4

data1 = data - base

sf = fit([x2(:),y2(:)],base(:),'poly22')
sf = fit([x2(:),y2(:)],data(:),'poly22')
sf = fit([x2(:),y2(:)],data1(:),'poly22')